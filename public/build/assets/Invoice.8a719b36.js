import{r as y,u as f,o as C,y as R,a as p,g as _,b as e,d as b,w as g,e as a,t as n,k as h,F as S,D as N,f as m,a0 as k,V as x,v as O,h as w,n as B,i as D,p as F,L as E,q as P,x as V}from"./app.ccec1e18.js";import{_ as q}from"./flogo.b45e8d3c.js";import{_ as A,a as M,b as j,c as U,d as X}from"./icon-youtube-white.12f5965b.js";import{_ as J}from"./_plugin-vue_export-helper.cdc0426e.js";const c=i=>(P("data-v-99e70505"),i=i(),V(),i),L={class:"invoice invoice-content invoice-1"},G={class:"back-top-home hover-up mt-30 ml-30"},K=c(()=>e("i",{class:"fi-rs-home mr-5"},null,-1)),H={class:"container"},W={class:"row"},$={class:"col-lg-12"},z={class:"invoice-inner"},Q={class:"invoice-info",id:"invoice_wrapper"},Y={class:"invoice-header"},Z={class:"row"},ee={class:"col-sm-6"},te={class:"invoice-name"},se={class:"logo"},oe=c(()=>e("img",{width:"200",src:q,alt:"logo"},null,-1)),ae={class:"col-sm-6"},ne={class:"invoice-numb"},ie={class:"text-end mb-10 mt-20"},re={class:"text-end invoice-header-1"},ce={class:"invoice-top"},le={class:"row"},de={class:"col-lg-9 col-md-6"},pe={class:"invoice-number"},_e=c(()=>e("h4",{class:"invoice-title-1 mb-10"},"Invoice To",-1)),me={class:"invoice-addr-1"},he=c(()=>e("br",null,null,-1)),ue=c(()=>e("br",null,null,-1)),ve={class:"invoice-center"},ye={class:"table-responsive"},fe={class:"table table-striped invoice-table"},be=c(()=>e("thead",{class:"bg-active"},[e("tr",null,[e("th",null,"Item name"),e("th",{class:"text-center"},"Unit Price"),e("th",{class:"text-center"},"Quantity"),e("th",{class:"text-right"},"Amount")])],-1)),ge={class:"item-desc-1"},ke={class:"text-center"},xe={class:"text-center"},we={class:"text-right"},Ee=c(()=>e("td",{colspan:"3",class:"text-end f-w-600"},"Grand Total",-1)),Ie={class:"text-right f-w-600"},Te={class:"invoice-bottom"},Ce={class:"row"},Re={class:"col-sm-6"},Se={class:"row"},Ne={class:"col-sm-12"},Oe=c(()=>e("h3",{class:"invoice-title-1"},"Payment Method",-1)),Be={action:""},De={class:"form-check"},Fe=c(()=>e("label",{class:"form-check-label",for:"flexRadioDefault1"}," Mpesa ",-1)),Pe={class:"form-check"},Ve=c(()=>e("label",{class:"form-check-label",for:"flexRadioDefault2"}," Paypal / Credit Card ",-1)),qe={class:"col-sm-12"},Ae={class:"input-group mb-3"},Me=c(()=>e("div",{class:"input-group-prepend"},[e("span",{style:{padding:"11px"},class:"input-group-text",id:"basic-addon1"},[e("strong",null,"+254")])],-1)),je={key:0,class:"invalid-feedback"},Ue={class:"form-group"},Xe=["onClick"],Je={id:"paypalContainer",class:"col-sm-12"},Le=F('<div class="col-sm-6 col-offsite" data-v-99e70505><div class="text-end" data-v-99e70505><p class="mb-0 text-13" data-v-99e70505>Thank you for your business</p><p data-v-99e70505><strong data-v-99e70505>Binasta Limited</strong></p><div class="mobile-social-icon mt-50 print-hide" data-v-99e70505><h6 data-v-99e70505>Follow Us</h6><a href="#" data-v-99e70505><img src="'+A+'" alt="" data-v-99e70505></a><a href="#" data-v-99e70505><img src="'+M+'" alt="" data-v-99e70505></a><a href="#" data-v-99e70505><img src="'+j+'" alt="" data-v-99e70505></a><a href="#" data-v-99e70505><img src="'+U+'" alt="" data-v-99e70505></a><a href="#" data-v-99e70505><img src="'+X+'" alt="" data-v-99e70505></a></div></div></div>',1),Ge={__name:"Invoice",props:{order:Object},setup(i){const u=i;let v=y(0),d=y(null);u.order.product_options.forEach(l=>{v.value+=parseInt(l.selling_price)*l.pivot.quantity});const I=f({order_ref:u.order.ref}),t=f({phone_number:"",payment_type:"mpesa",order_ref:u.order.ref}),T=()=>{if(t.clearErrors(),d.value=null,!t.phone_number||t.phone_number.trim()==""?t.setError("phone_number","Phone number is required"):t.phone_number.length>9&&t.setError("phone_number","Phone number is invalid. (Hint) Don't start with 0"),(!t.payment_type||t.payment_type.trim()=="")&&t.setError("payment_type","payment type is required"),(!t.order_ref||t.order_ref.trim()=="")&&t.setError("order_ref","Order ref is requireed"),t.errors&&Object.keys(t.errors).length)return;const l=document.getElementById("submitBtn");l.innerText="Making payment....",l.setAttribute("disabled",!0),fetch("/make_payment",{method:"POST",headers:{"Content-Type":"application/json","X-XSRF-TOKEN":decodeURIComponent(document.cookie.split(";").filter(s=>s.startsWith("XSRF-TOKEN="))[0].split("=")[1])},body:JSON.stringify({phone_number:t.phone_number,payment_type:t.payment_type,order_ref:t.order_ref})}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.log(s))};return C(()=>{let l=document.createElement("script");l.setAttribute("src","https://www.paypal.com/sdk/js?client-id=AaYT0UqlwWovXoGEp6qqBalZR32nG5gDXRVU546jy4_Gv_JrpRAF6fB8xp3gJ7cOTNmHJ-NVhAO4DxIC"),document.head.appendChild(l),l.addEventListener("load",()=>{paypal.Buttons({createOrder:(s,o)=>fetch("/make_payment",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":decodeURIComponent(document.cookie.split(";").filter(r=>r.startsWith("XSRF-TOKEN"))[0].split("=")[1])},body:JSON.stringify({payment_type:t.payment_type,order_ref:t.order_ref})}).then(r=>r.json()).then(r=>r.orderId).catch(r=>console.log("make payment paypal err",r)),onApprove:(s,o)=>{console.log(s),I.transform(r=>({...r,ref:s.orderID})).post("/capture/paypal",{onError:r=>{console.log("paypal capture err",r)}})}}).render("#paypalContainer")}),window.Echo.private(`payments.${R().props.value.auth.user.id}`).listen("MpesaPaymentCaptured",s=>{if(d.value={message:s.message},parseInt(s.status)===0)d.value.class="primary",window.location.href="https://dashboard.binasta.co.ke/orders";else{d.value.class="danger";const o=document.getElementById("submitBtn");o.removeAttribute("disabled"),o.innerText="Make payment"}})}),(l,s)=>(p(),_("div",L,[e("div",G,[b(a(E),{class:"hover-up",href:"/"},{default:g(()=>[K,h(" Homepage")]),_:1})]),e("div",H,[e("div",W,[e("div",$,[e("div",z,[e("div",Q,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[b(a(E),{href:"/"},{default:g(()=>[oe]),_:1})])])]),e("div",ae,[e("div",ne,[e("h6",ie,n(new Date(i.order.created_at).toDateString()),1),e("h6",re,"Invoice No: #"+n(i.order.ref),1)])])])]),e("div",ce,[e("div",le,[e("div",de,[e("div",pe,[_e,e("p",me,[e("strong",null,n(i.order.user.email),1),h(),he,h(" "+n(i.order.phone_number)+" ",1),ue,h(" "+n(i.order.location),1)])])])])]),e("div",ve,[e("div",ye,[e("table",fe,[be,e("tbody",null,[(p(!0),_(S,null,N(i.order.product_options,o=>(p(),_("tr",{key:o.id},[e("td",null,[e("div",ge,[e("span",null,n(o.product.name),1),e("small",null,"REF: "+n(i.order.ref),1)])]),e("td",ke,"ksh."+n(o.selling_price),1),e("td",xe,n(o.pivot.quantity),1),e("td",we,"ksh."+n(o.pivot.quantity*o.selling_price),1)]))),128)),e("tr",null,[Ee,e("td",Ie,"ksh."+n(a(v)),1)])])])])]),e("div",Te,[e("div",Ce,[e("div",Re,[e("div",Se,[e("div",Ne,[e("div",null,[Oe,e("form",Be,[e("div",De,[m(e("input",{class:"form-check-input","onUpdate:modelValue":s[0]||(s[0]=o=>a(t).payment_type=o),type:"radio",value:"mpesa",id:"flexRadioDefault1"},null,512),[[k,a(t).payment_type]]),Fe]),e("div",Pe,[m(e("input",{class:"form-check-input",type:"radio",value:"paypal","onUpdate:modelValue":s[1]||(s[1]=o=>a(t).payment_type=o),id:"flexRadioDefault2"},null,512),[[k,a(t).payment_type]]),Ve])])])]),m(e("div",qe,[e("div",Ae,[Me,m(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=o=>a(t).phone_number=o),placeholder:"Enter phone number",class:"form-control"},null,512),[[O,a(t).phone_number]])]),a(t).errors.phone_number?(p(),_("div",je,n(a(t).errors.phone_number),1)):w("",!0),a(d)?(p(),_("div",{key:1,class:B(`alert alert-${a(d).class}`),role:"alert"},[e("strong",null,n(a(d).message),1)],2)):w("",!0),e("div",Ue,[e("button",{onClick:D(T,["prevent"]),id:"submitBtn",class:"btn btn-lg btn-custom btn-download hover-up"},"Make Payment",8,Xe)])],512),[[x,a(t).payment_type=="mpesa"]]),m(e("div",Je,null,512),[[x,a(t).payment_type=="paypal"]])])]),Le])])])])])])])]))}},ze=J(Ge,[["__scopeId","data-v-99e70505"]]);export{ze as default};
