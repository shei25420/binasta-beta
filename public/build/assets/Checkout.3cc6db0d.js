import{u as b,r as k,z as w,o as x,a as l,c as S,w as v,b as e,k as i,t as n,e as t,g as d,h as p,f as h,v as g,p as E,d as I,L as P,F as C,i as O,x as q,y as B}from"./app.e8a7696d.js";import{_ as F}from"./img_loading.2f197810.js";import{_ as T}from"./ShopLayout.5bee667b.js";import{_ as V}from"./_plugin-vue_export-helper.cdc0426e.js";import"./flogo.b45e8d3c.js";import"./index.1872b0be.js";import"./icon-youtube-white.12f5965b.js";const c=m=>(q("data-v-49cdcf57"),m=m(),B(),m),A=c(()=>e("div",{class:"page-header breadcrumb-wrap"},[e("div",{class:"container"},[e("div",{class:"breadcrumb"},[e("a",{href:"index.html",rel:"nofollow"},[e("i",{class:"fi-rs-home mr-5"}),i("Home")]),e("span"),i(" Shop "),e("span"),i(" Checkout ")])])],-1)),L={class:"container mb-80 mt-50"},N={class:"row"},j={class:"col-lg-8 mb-40"},D=c(()=>e("h1",{class:"heading-2 mb-10"},"Checkout",-1)),U={class:"d-flex justify-content-between"},M={class:"text-body"},z={class:"text-brand"},R={class:"row"},$={class:"col-lg-7"},H={key:0,class:"row mb-50"},J=c(()=>e("div",{class:"col-lg-6 mb-sm-15 mb-lg-0 mb-md-3"},[e("div",{class:"toggle_info"},[e("span",null,[e("i",{class:"fi-rs-user mr-10"}),e("span",{class:"text-muted font-lg"},"Already have an account?"),i(),e("a",{href:"#loginform","data-bs-toggle":"collapse",class:"font-lg collapsed","aria-expanded":"false"},"Click here to login")])]),e("div",{class:"panel-collapse login_form collapse",id:"loginform",style:{}},[e("div",{class:"panel-body"},[e("p",{class:"mb-30 font-sm"},"If you have shopped with us before, please enter your details below. If you are a new customer, please proceed to the Billing & Shipping section."),e("form",{method:"post"},[e("div",{class:"form-group"},[e("input",{type:"text",name:"email",placeholder:"Username Or Email"})]),e("div",{class:"form-group"},[e("input",{type:"password",name:"password",placeholder:"Password"})]),e("div",{class:"login_footer form-group"},[e("div",{class:"chek-form"},[e("div",{class:"custome-checkbox"},[e("input",{class:"form-check-input",type:"checkbox",name:"checkbox",id:"remember",value:""}),e("label",{class:"form-check-label",for:"remember"},[e("span",null,"Remember me")])])]),e("a",{href:"#"},"Forgot password?")]),e("div",{class:"form-group"},[e("button",{class:"btn btn-md",name:"login"},"Log in")])])])])],-1)),Y=[J],K={key:1,class:"row"},Q=c(()=>e("h4",{class:"mb-30"},"Account Details",-1)),G={method:"post"},W={class:"row"},X={class:"form-group col-lg-6"},Z={key:0,class:"invalid-feedback"},ee={class:"form-group col-lg-6"},se={key:0,class:"invalid-feedback"},oe={class:"row"},te=c(()=>e("h4",{class:"mb-30 mt-5"},"Billing Details",-1)),re={method:"post"},ae={class:"row"},le={class:"form-group col-lg-6"},ce={key:0,class:"invalid-feedback"},ne={class:"form-group col-lg-6"},de={key:0,class:"invalid-feedback"},ie={class:"col-lg-5"},pe={class:"border p-40 cart-totals ml-30 mb-50"},ue=c(()=>e("div",{class:"d-flex align-items-end justify-content-between mb-30"},[e("h4",null,"Your Order"),e("h6",{class:"text-muted"},"Subtotal")],-1)),me=c(()=>e("div",{class:"divider-2 mb-30"},null,-1)),_e={class:"table-responsive order_table checkout"},he={class:"table no-border"},ge={class:"image product-thumbnail"},fe=["data-src","alt"],be={class:"w-160 mb-5"},ve={class:"text-muted pl-20 pr-20"},ye={class:"text-brand"},ke={class:"payment ml-30"},we=c(()=>e("h4",{class:"mb-30"},"Payment",-1)),xe=["onClick"],Se=c(()=>e("i",{class:"fi-rs-sign-out ml-15"},null,-1)),Ee={__name:"Checkout",setup(m){const f=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):null,s=b({location:"",phone_number:"",user_address_id:null,product_options:[]}),r=b({email:"",password:""}),_=k(w().props.value.auth.user),y=()=>{if(s.clearErrors(),r.clearErrors(),_.value||((!r.email||r.email.trim()=="")&&r.setError("email","email field is required"),(!r.password||r.password.trim()=="")&&r.setError("password","password field is required")),(!s.location||s.location.trim()=="")&&!s.user_address_id&&s.setError("location","delivery location is required"),(!s.phone_number||s.phone_number.trim()=="")&&!s.user_address_id&&s.setError("phone_number","phone number field is required"),r.errors&&Object.keys(r.errors).length||s.errors&&Object.keys(s.errors).length)return;JSON.parse(localStorage.getItem("cart")).forEach(o=>{s.product_options.push({id:o.option.id,qty:o.qty})});const a=document.getElementById("orderBtn");a.innerText="Placing Order...",_.value?s.post("/orders",{onSuccess:()=>{localStorage.removeItem("cart")},onError:()=>{a.innerText="Place Order"}}):r.post("/register",{onSuccess:()=>{s.post("/orders",{onSuccess:()=>{localStorage.removeItem("cart")},onError:()=>{a.innerText="Place Order"}})},onError:o=>{console.log("reg err"),a.innerText="Place Order"}})};return x(()=>{let u=document.createElement("script");u.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyBoR-KFcg8yHE4-x5xw4ixAQxYhkPbM4Tc&libraries=places"),document.head.appendChild(u),u.addEventListener("load",function(){const a=new google.maps.places.Autocomplete(document.getElementById("autocomplete"),{componentRestrictions:{country:"ke"}});google.maps.event.addListener(a,"place_changed",function(o){s.location=`${a.getPlace().name} ${a.getPlace().formatted_address}`})})}),(u,a)=>(l(),S(T,null,{default:v(()=>[A,e("div",L,[e("div",N,[e("div",j,[D,e("div",U,[e("h6",M,[i("There are "),e("span",z,n(t(f).length),1),i(" products in your cart")])])])]),e("div",R,[e("div",$,[_.value?p("",!0):(l(),d("div",H,Y)),_.value?p("",!0):(l(),d("div",K,[Q,e("form",G,[e("div",W,[e("div",X,[h(e("input",{type:"email",required:"","onUpdate:modelValue":a[0]||(a[0]=o=>t(r).email=o),placeholder:"Email Address *"},null,512),[[g,t(r).email]]),t(r).errors.email?(l(),d("div",Z,n(t(r).errors.email),1)):p("",!0)]),e("div",ee,[h(e("input",{type:"password",required:"","onUpdate:modelValue":a[1]||(a[1]=o=>t(r).password=o),placeholder:"Password *"},null,512),[[g,t(r).password]]),t(r).errors.password?(l(),d("div",se,n(t(r).errors.password),1)):p("",!0)])])])])),e("div",oe,[te,e("form",re,[e("div",ae,[e("div",le,[h(e("input",{type:"text",required:"",name:"fname","onUpdate:modelValue":a[2]||(a[2]=o=>t(s).phone_number=o),placeholder:"Contact Phone Number *"},null,512),[[g,t(s).phone_number]]),t(s).errors.phone_number?(l(),d("div",ce,n(t(s).errors.phone_number),1)):p("",!0)]),e("div",ne,[h(e("input",{type:"text",required:"",id:"autocomplete",name:"lname","onUpdate:modelValue":a[3]||(a[3]=o=>t(s).location=o),placeholder:"Delivery Location *"},null,512),[[g,t(s).location]]),t(s).errors.location?(l(),d("div",de,n(t(s).errors.location),1)):p("",!0)])])])])]),e("div",ie,[e("div",pe,[ue,me,e("div",_e,[e("table",he,[e("tbody",null,[(l(!0),d(C,null,E(t(f),o=>(l(),d("tr",{key:o.product.id},[e("td",ge,[e("img",{class:"lazy",src:F,"data-src":"/storage/"+o.product.images[0].url,alt:o.product.name},null,8,fe)]),e("td",null,[e("h6",be,[I(t(P),{href:"/products/"+o.product.slug,class:"text-heading"},{default:v(()=>[i(n(o.product.name),1)]),_:2},1032,["href"])])]),e("td",null,[e("h6",ve,"x "+n(o.qty),1)]),e("td",null,[e("h4",ye,"ksh."+n(o.product.discounts.length?(100-parseInt(o.product.discounts[0].percentage))/100*parseFloat(o.option.selling_price):parseFloat(o.option.selling_price)),1)])]))),128))])])])]),e("div",ke,[we,e("button",{href:"#",onClick:O(y,["prevent"]),id:"orderBtn",class:"btn btn-fill-out btn-block mt-30"},[i("Place an Order"),Se],8,xe)])])])])]),_:1}))}},Te=V(Ee,[["__scopeId","data-v-49cdcf57"]]);export{Te as default};
