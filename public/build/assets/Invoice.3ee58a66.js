import{r as f,u as y,o as C,y as R,z as S,a as p,g as _,b as e,d as b,w as g,e as o,t as n,k as h,F as N,D as O,f as m,a0 as k,V as x,v as B,h as w,n as D,i as F,p as P,L as E,q as V,x as q}from"./app.1ac5e0b9.js";import{_ as A}from"./flogo.b45e8d3c.js";import{_ as M,a as j,b as U,c as X,d as J}from"./icon-youtube-white.12f5965b.js";import{_ as L}from"./_plugin-vue_export-helper.cdc0426e.js";const c=i=>(V("data-v-aeaf3342"),i=i(),q(),i),G={class:"invoice invoice-content invoice-1"},K={class:"back-top-home hover-up mt-30 ml-30"},H=c(()=>e("i",{class:"fi-rs-home mr-5"},null,-1)),W={class:"container"},z={class:"row"},$={class:"col-lg-12"},Q={class:"invoice-inner"},Y={class:"invoice-info",id:"invoice_wrapper"},Z={class:"invoice-header"},ee={class:"row"},te={class:"col-sm-6"},se={class:"invoice-name"},ae={class:"logo"},oe=c(()=>e("img",{width:"200",src:A,alt:"logo"},null,-1)),ne={class:"col-sm-6"},ie={class:"invoice-numb"},re={class:"text-end mb-10 mt-20"},ce={class:"text-end invoice-header-1"},de={class:"invoice-top"},le={class:"row"},pe={class:"col-lg-9 col-md-6"},_e={class:"invoice-number"},me=c(()=>e("h4",{class:"invoice-title-1 mb-10"},"Invoice To",-1)),he={class:"invoice-addr-1"},ue=c(()=>e("br",null,null,-1)),ve=c(()=>e("br",null,null,-1)),fe={class:"invoice-center"},ye={class:"table-responsive"},be={class:"table table-striped invoice-table"},ge=c(()=>e("thead",{class:"bg-active"},[e("tr",null,[e("th",null,"Item name"),e("th",{class:"text-center"},"Unit Price"),e("th",{class:"text-center"},"Quantity"),e("th",{class:"text-right"},"Amount")])],-1)),ke={class:"item-desc-1"},xe={class:"text-center"},we={class:"text-center"},Ee={class:"text-right"},Ie=c(()=>e("td",{colspan:"3",class:"text-end f-w-600"},"Grand Total",-1)),Te={class:"text-right f-w-600"},Ce={class:"invoice-bottom"},Re={class:"row"},Se={class:"col-sm-6"},Ne={class:"row"},Oe={class:"col-sm-12"},Be=c(()=>e("h3",{class:"invoice-title-1"},"Payment Method",-1)),De={action:""},Fe={class:"form-check"},Pe=c(()=>e("label",{class:"form-check-label",for:"flexRadioDefault1"}," Mpesa ",-1)),Ve={class:"form-check"},qe=c(()=>e("label",{class:"form-check-label",for:"flexRadioDefault2"}," Paypal / Credit Card ",-1)),Ae={class:"col-sm-12"},Me={class:"input-group mb-3"},je=c(()=>e("div",{class:"input-group-prepend"},[e("span",{style:{padding:"11px"},class:"input-group-text",id:"basic-addon1"},[e("strong",null,"+254")])],-1)),Ue={key:0,class:"invalid-feedback"},Xe={class:"form-group"},Je=["onClick"],Le={id:"paypalContainer",class:"col-sm-12"},Ge=P('<div class="col-sm-6 col-offsite" data-v-aeaf3342><div class="text-end" data-v-aeaf3342><p class="mb-0 text-13" data-v-aeaf3342>Thank you for your business</p><p data-v-aeaf3342><strong data-v-aeaf3342>Binasta Limited</strong></p><div class="mobile-social-icon mt-50 print-hide" data-v-aeaf3342><h6 data-v-aeaf3342>Follow Us</h6><a href="#" data-v-aeaf3342><img src="'+M+'" alt="" data-v-aeaf3342></a><a href="#" data-v-aeaf3342><img src="'+j+'" alt="" data-v-aeaf3342></a><a href="#" data-v-aeaf3342><img src="'+U+'" alt="" data-v-aeaf3342></a><a href="#" data-v-aeaf3342><img src="'+X+'" alt="" data-v-aeaf3342></a><a href="#" data-v-aeaf3342><img src="'+J+'" alt="" data-v-aeaf3342></a></div></div></div>',1),Ke={__name:"Invoice",props:{order:Object},setup(i){const u=i;let v=f(0),l=f(null);u.order.product_options.forEach(d=>{v.value+=parseInt(d.selling_price)*d.pivot.quantity});const I=y({order_ref:u.order.ref}),t=y({phone_number:"",payment_type:"mpesa",order_ref:u.order.ref}),T=()=>{if(t.clearErrors(),l.value=null,!t.phone_number||t.phone_number.trim()==""?t.setError("phone_number","Phone number is required"):t.phone_number.length>9&&t.setError("phone_number","Phone number is invalid. (Hint) Don't start with 0"),(!t.payment_type||t.payment_type.trim()=="")&&t.setError("payment_type","payment type is required"),(!t.order_ref||t.order_ref.trim()=="")&&t.setError("order_ref","Order ref is requireed"),t.errors&&Object.keys(t.errors).length)return;const d=document.getElementById("submitBtn");d.innerText="Making payment....",d.setAttribute("disabled",!0),fetch("/make_payment",{method:"POST",headers:{"Content-Type":"application/json","X-XSRF-TOKEN":decodeURIComponent(document.cookie.split(";").filter(s=>s.startsWith("XSRF-TOKEN="))[0].split("=")[1])},body:JSON.stringify({phone_number:t.phone_number,payment_type:t.payment_type,order_ref:t.order_ref})}).then(s=>s.json()).then(s=>console.log(s)).catch(s=>console.log(s))};return C(()=>{let d=document.createElement("script");d.setAttribute("src","https://www.paypal.com/sdk/js?client-id=AaYT0UqlwWovXoGEp6qqBalZR32nG5gDXRVU546jy4_Gv_JrpRAF6fB8xp3gJ7cOTNmHJ-NVhAO4DxIC"),document.head.appendChild(d),d.addEventListener("load",()=>{paypal.Buttons({createOrder:(s,a)=>fetch("/make_payment",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-XSRF-TOKEN":decodeURIComponent(document.cookie.split(";").filter(r=>r.startsWith("XSRF-TOKEN"))[0].split("=")[1])},body:JSON.stringify({payment_type:t.payment_type,order_ref:t.order_ref})}).then(r=>r.json()).then(r=>r.orderId).catch(r=>console.log("make payment paypal err",r)),onApprove:(s,a)=>{console.log(s),I.transform(r=>({...r,ref:s.orderID})).post("/capture/paypal",{onError:r=>{console.log("paypal capture err",r)}})}}).render("#paypalContainer")}),window.Echo.private(`payments.${R().props.value.auth.user.id}`).listen("MpesaPaymentCaptured",s=>{if(l.value={message:s.message},parseInt(s.status)===0)l.value.class="primary",S.Inertia.visit("https://dashboard.binasta.co.ke/orders");else{l.value.class="danger";const a=document.getElementById("submitBtn");a.removeAttribute("disabled"),a.innerText="Make payment"}})}),(d,s)=>(p(),_("div",G,[e("div",K,[b(o(E),{class:"hover-up",href:"/"},{default:g(()=>[H,h(" Homepage")]),_:1})]),e("div",W,[e("div",z,[e("div",$,[e("div",Q,[e("div",Y,[e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[e("div",ae,[b(o(E),{href:"/"},{default:g(()=>[oe]),_:1})])])]),e("div",ne,[e("div",ie,[e("h6",re,n(new Date(i.order.created_at).toDateString()),1),e("h6",ce,"Invoice No: #"+n(i.order.ref),1)])])])]),e("div",de,[e("div",le,[e("div",pe,[e("div",_e,[me,e("p",he,[e("strong",null,n(i.order.user.email),1),h(),ue,h(" "+n(i.order.phone_number)+" ",1),ve,h(" "+n(i.order.location),1)])])])])]),e("div",fe,[e("div",ye,[e("table",be,[ge,e("tbody",null,[(p(!0),_(N,null,O(i.order.product_options,a=>(p(),_("tr",{key:a.id},[e("td",null,[e("div",ke,[e("span",null,n(a.product.name),1),e("small",null,"REF: "+n(i.order.ref),1)])]),e("td",xe,"ksh."+n(a.selling_price),1),e("td",we,n(a.pivot.quantity),1),e("td",Ee,"ksh."+n(a.pivot.quantity*a.selling_price),1)]))),128)),e("tr",null,[Ie,e("td",Te,"ksh."+n(o(v)),1)])])])])]),e("div",Ce,[e("div",Re,[e("div",Se,[e("div",Ne,[e("div",Oe,[e("div",null,[Be,e("form",De,[e("div",Fe,[m(e("input",{class:"form-check-input","onUpdate:modelValue":s[0]||(s[0]=a=>o(t).payment_type=a),type:"radio",value:"mpesa",id:"flexRadioDefault1"},null,512),[[k,o(t).payment_type]]),Pe]),e("div",Ve,[m(e("input",{class:"form-check-input",type:"radio",value:"paypal","onUpdate:modelValue":s[1]||(s[1]=a=>o(t).payment_type=a),id:"flexRadioDefault2"},null,512),[[k,o(t).payment_type]]),qe])])])]),m(e("div",Ae,[e("div",Me,[je,m(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=a=>o(t).phone_number=a),placeholder:"Enter phone number",class:"form-control"},null,512),[[B,o(t).phone_number]])]),o(t).errors.phone_number?(p(),_("div",Ue,n(o(t).errors.phone_number),1)):w("",!0),o(l)?(p(),_("div",{key:1,class:D(`alert alert-${o(l).class}`),role:"alert"},[e("strong",null,n(o(l).message),1)],2)):w("",!0),e("div",Xe,[e("button",{onClick:F(T,["prevent"]),id:"submitBtn",class:"btn btn-lg btn-custom btn-download hover-up"},"Make Payment",8,Je)])],512),[[x,o(t).payment_type=="mpesa"]]),m(e("div",Le,null,512),[[x,o(t).payment_type=="paypal"]])])]),Ge])])])])])])])]))}},Qe=L(Ke,[["__scopeId","data-v-aeaf3342"]]);export{Qe as default};
