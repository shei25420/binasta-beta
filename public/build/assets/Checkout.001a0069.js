import{u as y,r as k,o as x,a as n,c as S,w,b as t,f as b,v as g,e as c,g as d,t as i,h as v,p as E,F as C,x as I,y as B,k as F}from"./app.5a4f4dca.js";import{_ as A}from"./GenericLayout.e89dcb7e.js";import{_ as P}from"./_plugin-vue_export-helper.cdc0426e.js";import"./app.min.336110c7.js";import"./index.8ed95ae7.js";const r=l=>(I("data-v-68e37100"),l=l(),B(),l),T=r(()=>t("div",{class:"mb-4"},[t("nav",{"aria-label":"breadcrumb"},[t("ol",{class:"breadcrumb"},[t("li",{class:"breadcrumb-item"},[t("a",{href:"#"},[t("i",{class:"bi bi-globe2 small me-2"}),F(" Dashboard ")])]),t("li",{class:"breadcrumb-item active","aria-current":"page"},"Checkout")])])],-1)),q={class:"row"},j={class:"col-md-8"},O=r(()=>t("h3",{id:"checkout-form-wizard-h-0",class:"title current"},"Billing",-1)),V={class:"card card-body mb-0 body current"},D=r(()=>t("div",{class:"mb-4"},[t("div",{class:"text-muted"},"Enter your billing information")],-1)),L={class:"row g-4 mb-3"},N={class:"col-md-6"},$=r(()=>t("label",{class:"form-label"},"Contact Phone",-1)),z={key:0,class:"invalid-feedback"},M={class:"col-md-6"},R=r(()=>t("label",{class:"form-label"},"Delivery Location",-1)),U={key:0,class:"invalid-feedback"},H={class:"col-md-4"},J=r(()=>t("h5",{class:"mb-4"},"Order Summary",-1)),K={class:"card mb-4"},Q={class:"card-body"},Y=r(()=>t("h6",{class:"card-title mb-4"},"Products",-1)),G={class:"list-group list-group-flush"},W={href:"#",class:"me-3"},X=["data-src"],Z={class:"text-end ms-auto"},tt={class:"card mb-4"},et={class:"card-body"},st=r(()=>t("h6",{class:"card-title mb-4"},"Price",-1)),ot={class:"row justify-content-center mb-3"},at=r(()=>t("div",{class:"col-4 text-end"},"Sub Total :",-1)),ct={class:"col-4"},rt=r(()=>t("div",{class:"row justify-content-center mb-3"},[t("div",{class:"col-4 text-end"},"Shipping :"),t("div",{class:"col-4"},"Free")],-1)),it={class:"row justify-content-center"},nt=r(()=>t("div",{class:"col-4 text-end"},[t("strong",null,"Total :")],-1)),lt={class:"col-4"},dt={__name:"Checkout",setup(l){const u=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):null,e=y({location:"",phone_number:"",distributor_address_id:null,distributor_packages:[]});let _=k(0);const m=a=>{let s=0,o=0,p=a.discounts.length?(100-a.discounts[0].percentage)/100:0;return a.product_options.forEach(h=>{o+=parseFloat(h.price),s+=parseFloat(h.price)}),s=p?p*s:s,[s,o]},f=()=>{if(e.clearErrors(),(!e.location||e.location.trim()=="")&&!e.distributor_address_id&&e.setError("location","delivery location is required"),(!e.phone_number||e.phone_number.trim()=="")&&!e.distributor_address_id&&e.setError("phone_number","phone number field is required"),e.errors&&Object.keys(e.errors).length)return;const a=document.getElementById("submitBtn");a.innerText="Checking out...",a.setAttribute("disabled",!0),e.post("/orders",{onSuccess:()=>{localStorage.removeItem("cart")},onError:()=>{a.innerText="Place Order"},onFinish:()=>{a.innerText="Checking out...",a.removeAttribute("disabled")}})};return x(()=>{u&&u.forEach(s=>{_.value+=m(s.distributor_package)[0]*parseInt(s.qty),e.distributor_packages.push({id:s.distributor_package.id,qty:s.qty})});let a=document.createElement("script");a.setAttribute("src","https://maps.googleapis.com/maps/api/js?key=AIzaSyBoR-KFcg8yHE4-x5xw4ixAQxYhkPbM4Tc&libraries=places"),document.head.appendChild(a),a.addEventListener("load",function(){const s=new google.maps.places.Autocomplete(document.getElementById("autocomplete"),{componentRestrictions:{country:"ke"}});google.maps.event.addListener(s,"place_changed",function(o){e.location=`${s.getPlace().name} ${s.getPlace().formatted_address}`})})}),(a,s)=>(n(),S(A,null,{default:w(()=>[T,t("div",q,[t("div",j,[O,t("section",V,[D,t("div",L,[t("div",N,[$,b(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=o=>c(e).phone_number=o)},null,512),[[g,c(e).phone_number]]),c(e).errors.phone_number?(n(),d("div",z,i(c(e).errors.phone_number),1)):v("",!0)]),t("div",M,[R,b(t("input",{id:"autocomplete",type:"text",class:"form-control","onUpdate:modelValue":s[1]||(s[1]=o=>c(e).location=o)},null,512),[[g,c(e).location]]),c(e).errors.location?(n(),d("div",U,i(c(e).errors.location),1)):v("",!0)])])])]),t("div",H,[J,t("div",K,[t("div",Q,[Y,t("div",G,[(n(!0),d(C,null,E(c(u),o=>(n(),d("div",{key:o.distributor_package.id,class:"list-group-item d-flex px-0"},[t("a",W,[t("img",{src:"/shop/imgs/theme/img_loading.gif","data-src":`/storage/${o.distributor_package.image_path}`,class:"lazy rounded",width:"60",alt:"..."},null,8,X)]),t("div",null,[t("h6",null,i(o.distributor_package.name),1),t("div",null,i(o.qty)+" x ksh."+i(m(o.distributor_package)[0]),1)]),t("div",Z,"ksh."+i(m(o.distributor_package)[0]*o.qty),1)]))),128))])])]),t("div",tt,[t("div",et,[st,t("div",ot,[at,t("div",ct,"ksh."+i(c(_)),1)]),rt,t("div",it,[nt,t("div",lt,[t("strong",null,"ksh."+i(c(_)),1)])])])]),t("div",{class:"card"},[t("div",{class:"card-body"},[t("button",{onClick:f,id:"submitBtn",class:"btn btn-outline-primary btn-icon"}," Checkout ")])])])])]),_:1}))}},bt=P(dt,[["__scopeId","data-v-68e37100"]]);export{bt as default};
