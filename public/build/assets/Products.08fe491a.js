import{u as x,r as b,o as P,$ as f,z as E,S,a as d,c as C,w as p,b as t,d as g,e as o,f as v,v as y,g as l,t as c,h as m,R as B,D as I,F as N,i as V,k as D}from"./app.ccec1e18.js";import{e as h,D as T}from"./dataTables.bootstrap5.9dec3023.js";import"./dataTables.responsive.956ef27e.js";import{C as $}from"./ckeditor.a41fef82.js";import{_ as A}from"./GenericLayout.8882146b.js";import{_ as U}from"./ModalComponent.1332cfd8.js";import"./app.min.c51efb0b.js";import"./_plugin-vue_export-helper.cdc0426e.js";const F={class:"card"},M=t("div",{class:"card-header"},[t("h4",null,"Products"),t("button",{id:"modalBtn",type:"button","data-bs-toggle":"modal","data-bs-target":"#exampleModal",class:"btn btn-icon btn-primary"},[t("i",{class:"bi bi-plus-circle"}),D(" Add Product ")])],-1),q={class:"card-body"},O=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Category"),t("th",null,"Product Image"),t("th",null,"Product Options"),t("th",null,"Created At"),t("th",null,"Actions")])],-1),z=["onSubmit"],L={class:"row"},j={class:"col"},R={class:"form-group"},G=t("label",{for:"Product Name"},"Product Name",-1),H={key:0,class:"invalid-feedback"},J={class:"row mt-3"},K={class:"col"},Q={class:"form-group"},W=t("label",{for:"Product Category"},"Product Category",-1),X=t("option",{value:""},"Select Category",-1),Y=["value"],Z={key:0,class:"invalid-feedback"},ee={class:"row"},te={class:"col"},se={class:"form-group"},oe=t("label",{for:"Ingredients"},"Ingredients",-1),re={key:0,class:"invalid-feedback"},ie={class:"row mt-3"},ae={class:"col"},ne={class:"form-group"},de=t("label",{for:"Description"},"Description",-1),le={key:0,class:"invalid-feedback"},ce={class:"row mt-3"},ue={class:"col"},me={class:"form-group"},_e=t("label",{for:"Feature Images"},"Feature Images",-1),pe={key:0,class:"invalid-feedback"},ge={class:"row mt-4"},ve={class:"col"},be=t("button",{type:"button",class:"btn btn-danger",style:{"margin-right":"10px"},"data-bs-dismiss":"modal"},"Close",-1),fe={id:"submitBtn",type:"submit",class:"btn btn-primary"},Ce={__name:"Products",props:{products:Array,categories:Array},setup(_){const k=_;h.use(T);const e=x({name:"",product_category_id:"",description:"",ingredients:"",images:null}),n=b(!1),a=b(null),w=()=>{if(e.clearErrors(),(!e.name||e.name.trim()=="")&&e.setError("name","name is required"),(!e.product_category_id||parseInt(e.product_category_id)==NaN)&&e.setError("product_category_id","product category is required"),(!e.description||e.description.trim()=="")&&e.setError("description","description is required"),(!e.ingredients||e.ingredients.trim()=="")&&e.setError("ingredients","ingredients is required"),!n.value&&(!e.images||e.images.length!=2)&&e.setError("images","2 images are required (front & back)"),e.errors&&Object.keys(e.errors).length)return;const i=document.getElementById("submitBtn");n.value?(i.innerText="Updating...",e.post(`/products/update/${a.value.id}`,{onSuccess(){e.reset(),n.value=!1,a.value=null,i.innerText="Save"},onError(){i.innerText="Update"}})):(i.innerText="Saving....",e.post("/products",{onSuccess(){e.reset()},onFinish(){i.innerText="Save"}}))};return P(()=>{document.getElementById("dt").addEventListener("click",function(i){if(i.target.nodeName!=="BUTTON")return;const r=i.target.getAttribute("data-id"),u=i.target.getAttribute("data-type");u==="del"?confirm("Are you sure you want to delete this product?")&&e.delete(`/products/${r}`):u==="edit"?(a.value=k.products.filter(({id:s})=>s==r)[0],e.name=a.value.name,e.product_category_id=a.value.product_category_id,e.description=a.value.description,e.ingredients=a.value.ingredients,e.images=a.value.images,n.value=!0,f("#modalBtn").click()):u==="view"&&E.Inertia.visit(`/products/${r}`)}),f("#exampleModal").on("hide.bs.modal",function(){n.value&&(n.value=!1,a.value=null)})}),(i,r)=>{const u=S("ckeditor");return d(),C(A,null,{default:p(()=>[t("div",F,[M,t("div",q,[g(o(h),{options:{responsive:!0},columns:[{data:"name"},{data:"product_category",render:s=>s.name},{data:"images",render:s=>`<img class='img img-fluid lazy' src='/shop/imgs/theme/img_loading.gif' data-src='/storage/${s[0].url}' width=150/>`},{data:"product_options_count",render:s=>s?"<span class='badge bg-success'>Complete ("+s+")</span>":"<span class='badge bg-danger'>Incomplete</span>"},{data:"created_at",render:s=>new Date(s).toDateString()},{data:null,render:s=>`<button data-type='view' data-id='${s.id}' class='btn btn-sm btn-primary mr-4'>View</button> <button data-type='edit' data-id='${s.id}' class='btn btn-sm btn-secondary mr-3'>Edit</button> <button class='btn btn-sm btn-danger' data-type='del' data-id='${s.id}'>Delete</button>`}],data:_.products,class:"table table-responsive display",id:"dt"},{default:p(()=>[O]),_:1},8,["columns","data"])])]),g(U,{title:n.value?"Update Product":"Add Product"},{default:p(()=>[t("form",{onSubmit:V(w,["prevent"])},[t("div",L,[t("div",j,[t("div",R,[G,v(t("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=s=>o(e).name=s),class:"form-control"},null,512),[[y,o(e).name]]),o(e).errors.name?(d(),l("div",H,c(o(e).errors.name),1)):m("",!0)])])]),t("div",J,[t("div",K,[t("div",Q,[W,v(t("select",{class:"form-control","onUpdate:modelValue":r[1]||(r[1]=s=>o(e).product_category_id=s)},[X,(d(!0),l(N,null,I(_.categories,s=>(d(),l("option",{value:s.id,key:s.id},c(s.name),9,Y))),128))],512),[[B,o(e).product_category_id]]),o(e).errors.product_category_id?(d(),l("div",Z,c(o(e).errors.product_category_id),1)):m("",!0)])])]),t("div",ee,[t("div",te,[t("div",se,[oe,v(t("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=s=>o(e).ingredients=s),class:"form-control"},null,512),[[y,o(e).ingredients]]),o(e).errors.ingredients?(d(),l("div",re,c(o(e).errors.ingredients),1)):m("",!0)])])]),t("div",ie,[t("div",ae,[t("div",ne,[de,g(u,{editor:o($),modelValue:o(e).description,"onUpdate:modelValue":r[3]||(r[3]=s=>o(e).description=s)},null,8,["editor","modelValue"]),o(e).errors.description?(d(),l("div",le,c(o(e).errors.description),1)):m("",!0)])])]),t("div",ce,[t("div",ue,[t("div",me,[_e,t("input",{type:"file",onInput:r[4]||(r[4]=s=>o(e).images=s.target.files),class:"form-control",multiple:""},null,32),o(e).errors.images?(d(),l("div",pe,c(o(e).errors.images),1)):m("",!0)])])]),t("div",ge,[t("div",ve,[be,t("button",fe,c(n.value?"Update":"Save"),1)])])],40,z)]),_:1},8,["title"])]),_:1})}}};export{Ce as default};
